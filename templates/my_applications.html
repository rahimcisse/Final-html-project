<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Applications - Iconnect</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='icon.ico') }}">
<script>
tailwind.config = {
darkMode: 'class',
theme: {
extend: {
colors: {
primary:'#3b82f6',
secondary:'#10b981',
dark: {
900: '#111827',
800: '#1F2937',
700: '#374151',
600: '#4B5563',
500: '#6B7280',
400: '#9CA3AF'
}
},
borderRadius: {
'none':'0px',
'sm':'4px',
DEFAULT:'8px',
'md':'12px',
'lg':'16px',
'xl':'20px',
'2xl':'24px',
'3xl':'32px',
'full':'9999px',
'button':'8px'
}
}
}
}
</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
<link rel="stylesheet" href="/static/main.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    .account-dropdown {
        display: none;
        position: absolute;
        right: 0;
        top: 100%;
        min-width: 200px;
        background: white;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        border-radius: 8px;
        z-index: 100;
    }
    .account-dropdown.show {
        display: block;
    }
    .account-dropdown a {
        display: block;
        padding: 12px 16px;
        color: #4b5563;
        transition: all 0.2s;
    }
    .account-dropdown a:hover {
        background: #f3f4f6;
        color: #1e40af;
    }
    .account-dropdown hr {
        border-color: #e5e7eb;
        margin: 4px 0;
    }
    .dark .account-dropdown {
        background: #1F2937;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
    }
    .dark .account-dropdown a {
        color: #9CA3AF;
    }
    .dark .account-dropdown a:hover {
        background: #374151;
        color: #3b82f6;
    }
    .dark .account-dropdown hr {
        border-color: #374151;
    }
    .application-card {
        border-left: 4px solid #3b82f6;
        transition: all 0.3s ease;
    }
    .application-card:hover {
        background-color: #f8fafc;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    .dark .application-card:hover {
        background-color: #374151;
    }
    .unavailable-card {
        border-left: 4px solid #ef4444;
        background-color: #fef2f2;
        opacity: 0.8;
    }
    .dark .unavailable-card {
        background-color: #7f1d1d;
    }
    .status-badge {
        padding: 4px 12px;
        border-radius: 9999px;
        font-size: 0.75rem;
        font-weight: 500;
    }
    .status-available {
        background-color: #d1fae5;
        color: #065f46;
    }
    .status-unavailable {
        background-color: #fee2e2;
        color: #991b1b;
    }
    
    /* Modal Styles */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        animation: fadeIn 0.3s ease;
    }
    
    .modal-overlay.show {
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .modal-content {
        background: white;
        border-radius: 12px;
        padding: 24px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        animation: slideUp 0.3s ease;
    }
    
    .dark .modal-content {
        background: #1F2937;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    @keyframes slideUp {
        from {
            transform: translateY(20px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }
    
    /* Toast Notification Styles */
    .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: white;
        border-radius: 8px;
        padding: 16px 20px;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        display: flex;
        align-items: center;
        gap: 12px;
        z-index: 2000;
        animation: slideInRight 0.3s ease;
        max-width: 400px;
    }
    
    .dark .toast {
        background: #1F2937;
    }
    
    .toast.success {
        border-left: 4px solid #10b981;
    }
    
    .toast.error {
        border-left: 4px solid #ef4444;
    }
    
    @keyframes slideInRight {
        from {
            transform: translateX(400px);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    
    @keyframes slideOutRight {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(400px);
            opacity: 0;
        }
    }
</style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-200">
    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex items-start mb-4">
                <div class="flex-shrink-0 bg-red-100 dark:bg-red-900/20 rounded-full p-3">
                    <i class="fas fa-exclamation-triangle text-red-600 dark:text-red-400 text-xl"></i>
                </div>
                <div class="ml-4 flex-1">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2" id="modalTitle">Confirm Action</h3>
                    <p class="text-gray-600 dark:text-gray-400 text-sm" id="modalMessage">Are you sure?</p>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-6">
                <button onclick="closeModal()" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 font-medium transition-colors">
                    Cancel
                </button>
                <button id="confirmButton" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium transition-colors">
                    Confirm
                </button>
            </div>
        </div>
    </div>
    <!-- Header -->
    <header class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50 transition-colors duration-200">
        <div class="container mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center">
                <a href="/" class="text-2xl font-['Pacifico'] text-primary mr-10">Iconnect</a>
                <nav class="hidden md:flex space-x-8">
                    <a href="index" class="text-gray-700 dark:text-gray-200 hover:text-primary dark:hover:text-primary font-medium">Home</a>
                    <a href="client-dashboard" data-role-only="Client" class="text-gray-700 dark:text-gray-200 hover:text-primary dark:hover:text-primary font-medium">Dashboard</a>
                    <a href="my-applications" data-role-only="Job Seeker" class="text-primary dark:text-primary font-medium border-b-2 border-primary">Applications</a>
                    <a href="browse" data-role-only="Client" class="text-gray-700 dark:text-gray-200 hover:text-primary dark:hover:text-primary font-medium">Browse Workers</a>
                    <a href="clients" data-role-only="Job Seeker" class="text-gray-700 dark:text-gray-200 hover:text-primary dark:hover:text-primary font-medium">Browse Clients</a>
                    <a href="how_it_works" class="text-gray-700 dark:text-gray-200 hover:text-primary dark:hover:text-primary font-medium">How It Works</a>
                    <a href="about" class="text-gray-700 dark:text-gray-200 hover:text-primary dark:hover:text-primary font-medium">About Us</a>
                </nav>
            </div>
            <div class="flex items-center space-x-4">
                <!-- Account Button with Dropdown -->
                <div class="relative">
                    <button id="accountButton" class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-primary">
                        <i class="ri-account-circle-line ri-xl"></i>
                        <span class="hidden md:inline">Account</span>
                        <i class="ri-arrow-down-s-line" id="accountArrow"></i>
                    </button>
                    
                    <div id="accountDropdown" class="account-dropdown">
                        <a href="/account"><i class="ri-user-line mr-2"></i>Profile</a>
                        <a href="/my-applications" data-role-only="Job Seeker"><i class="ri-file-list-line mr-2"></i>My Applications</a>
                        <a href="/client-dashboard" data-role-only="Client"><i class="ri-dashboard-line mr-2"></i>Dashboard</a>
                        <hr>
                        <a href="/help"><i class="ri-question-line mr-2"></i>Help Center</a>
                        <a href="#" onclick="logout()"><i class="ri-logout-box-line mr-2"></i>Logout</a>
                    </div>
                </div>
                
                <div class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800 cursor-pointer" id="mobileMenuToggle">
                    <i class="ri-menu-line ri-lg dark:text-gray-300"></i>
                </div>
                <div class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800 cursor-pointer" id="darkModeToggle">
                    <i class="ri-sun-line ri-lg dark:text-gray-300" id="themeIcon"></i>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Applications List -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow transition-colors duration-200">
            <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex justify-between items-center">
                    <div>
                        <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Application History</h2>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Track all your job applications in one place</p>
                    </div>
                    <a href="/clients" class="bg-primary text-white px-4 py-2 rounded-lg font-medium hover:bg-primary/90 transition-colors">
                        <i class="fas fa-search mr-2"></i>Browse More Jobs
                    </a>
                </div>
            </div>
            
            <div id="applicationsContainer" class="p-6">
                <!-- Loading state -->
                <div id="loadingState" class="text-center py-8">
                    <i class="fas fa-spinner fa-spin text-2xl text-gray-400 mb-2"></i>
                    <p class="text-gray-600 dark:text-gray-400">Loading your applications...</p>
                </div>
                
                <!-- Empty state -->
                <div id="emptyState" class="text-center py-8 hidden">
                    <i class="fas fa-inbox text-4xl text-gray-400 mb-4"></i>
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">No applications yet</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Start applying to jobs to see your application history here.</p>
                    <a href="/clients" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        Browse Jobs
                    </a>
                </div>
                
                <!-- Applications will be loaded here -->
                <div id="applicationsList" class="space-y-4"></div>
            </div>
        </div>
    </div>

    <script>
        // Modal and Toast Functions
        let confirmCallback = null;
        
        function showModal(title, message, onConfirm) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').textContent = message;
            confirmCallback = onConfirm;
            document.getElementById('confirmModal').classList.add('show');
        }
        
        function closeModal() {
            document.getElementById('confirmModal').classList.remove('show');
            confirmCallback = null;
        }
        
        document.getElementById('confirmButton').addEventListener('click', function() {
            if (confirmCallback) {
                confirmCallback();
                confirmCallback = null;
            }
            closeModal();
        });
        
        // Close modal when clicking outside
        document.getElementById('confirmModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icon = type === 'success' 
                ? '<i class="fas fa-check-circle text-green-600 dark:text-green-400 text-xl"></i>'
                : '<i class="fas fa-exclamation-circle text-red-600 dark:text-red-400 text-xl"></i>';
            
            toast.innerHTML = `
                ${icon}
                <span class="text-gray-900 dark:text-white font-medium">${message}</span>
                <button onclick="this.parentElement.remove()" class="ml-auto text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            loadMyApplications();
        });

        function loadMyApplications() {
            const loadingState = document.getElementById('loadingState');
            const emptyState = document.getElementById('emptyState');
            const applicationsList = document.getElementById('applicationsList');

            fetch('/api/my-applications')
                .then(response => response.json())
                .then(applications => {
                    loadingState.classList.add('hidden');
                    
                    if (applications.length === 0) {
                        emptyState.classList.remove('hidden');
                        return;
                    }

                    applications.forEach(app => {
                        const isUnavailable = app.status === 'unavailable';
                        const statusClass = isUnavailable ? 'status-unavailable' : 'status-available';
                        const statusText = isUnavailable ? 'No Longer Available' : 'Open';
                        const cardClass = isUnavailable ? 'application-card unavailable-card' : 'application-card';

                        const applicationCard = document.createElement('div');
                        applicationCard.className = `${cardClass} bg-white dark:bg-gray-700 rounded-lg p-6 shadow-sm`;
                        
                        applicationCard.innerHTML = `
                            <div class="flex justify-between items-start mb-4">
                                <div class="flex-1">
                                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">${app.title}</h3>
                                    <div class="flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400">
                                        <span><i class="fas fa-building mr-1"></i>${app.company_name || 'Company not specified'}</span>
                                        <span><i class="fas fa-map-marker-alt mr-1"></i>${app.location}</span>
                                        <span><i class="fas fa-briefcase mr-1"></i>${app.job_type}</span>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <span class="status-badge ${statusClass}">${statusText}</span>
                                    ${app.applied_at ? `<p class="text-xs text-gray-500 dark:text-gray-400 mt-2">Applied: ${new Date(app.applied_at).toLocaleDateString()}</p>` : ''}
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <p class="text-gray-700 dark:text-gray-300 text-sm line-clamp-2">${app.description || 'No description available'}</p>
                            </div>
                            
                            <div class="flex justify-between items-center">
                                <div class="flex items-center space-x-4 text-sm">
                                    ${app.salary ? `<span class="text-green-600 font-medium"><i class="fas fa-dollar-sign mr-1"></i>${app.salary}</span>` : ''}
                                    ${app.duration ? `<span class="text-blue-600"><i class="fas fa-clock mr-1"></i>${app.duration}</span>` : ''}
                                    ${app.experience ? `<span class="text-purple-600"><i class="fas fa-star mr-1"></i>${app.experience}</span>` : ''}
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="viewJobDetails(${app.id})" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                                        <i class="fas fa-eye mr-1"></i>View Details
                                    </button>
                                    ${isUnavailable ? 
                                        '<span class="text-red-600 text-sm font-medium"><i class="fas fa-times-circle mr-1"></i>Job Removed</span>' : 
                                        `<button onclick="deleteApplication(${app.id}, '${app.title.replace(/'/g, "\\'")}')" class="text-red-600 hover:text-red-800 text-sm font-medium">
                                            <i class="fas fa-trash mr-1"></i>Delete Application
                                        </button>`
                                    }
                                </div>
                            </div>
                        `;
                        
                        applicationsList.appendChild(applicationCard);
                    });
                })
                .catch(error => {
                    console.error('Error loading applications:', error);
                    loadingState.classList.add('hidden');
                    applicationsList.innerHTML = `
                        <div class="text-center py-8">
                            <i class="fas fa-exclamation-triangle text-4xl text-red-400 mb-4"></i>
                            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">Error Loading Applications</h3>
                            <p class="text-gray-600 dark:text-gray-400">Please try refreshing the page.</p>
                        </div>
                    `;
                });
        }

        function viewJobDetails(jobId) {
            // Redirect to job details or open modal
            window.location.href = `/clients?view=${jobId}`;
        }

        function deleteApplication(jobId, jobTitle) {
            // Show confirmation modal instead of alert
            showModal(
                'Delete Application',
                `Are you sure you want to delete your application for "${jobTitle}"? This action cannot be undone.`,
                function() {
                    // Show loading state
                    const button = event.target.closest('button');
                    const originalContent = button.innerHTML;
                    button.innerHTML = '<i class="fas fa-spinner fa-spin mr-1"></i>Deleting...';
                    button.disabled = true;

                    // Send delete request
                    fetch(`/api/jobs/${jobId}/application`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.error) {
                            showToast('Error: ' + data.error, 'error');
                            button.innerHTML = originalContent;
                            button.disabled = false;
                        } else {
                            // Show success toast
                            showToast('Application deleted successfully!', 'success');
                            // Reload the applications list after a short delay
                            setTimeout(() => location.reload(), 1500);
                        }
                    })
                    .catch(error => {
                        console.error('Error deleting application:', error);
                        showToast('Failed to delete application. Please try again.', 'error');
                        button.innerHTML = originalContent;
                        button.disabled = false;
                    });
                }
            );
        }
    </script>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white pt-16 pb-8 mt-16">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8 mb-12">
                <div class="lg:col-span-2">
                    <a href="#" class="text-2xl font-['Pacifico'] text-white mb-4 inline-block">Iconnect</a>
                    <p class="text-gray-400 mb-6 max-w-md">Connecting skilled professionals with businesses looking for quality talent. Our platform makes it easy to find work or hire the perfect candidate.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-800 hover:bg-primary transition-colors">
                            <i class="ri-facebook-fill"></i>
                        </a>
                        <a href="#" class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-800 hover:bg-primary transition-colors">
                            <i class="ri-twitter-fill"></i>
                        </a>
                        <a href="#" class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-800 hover:bg-primary transition-colors">
                            <i class="ri-linkedin-fill"></i>
                        </a>
                        <a href="#" class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-800 hover:bg-primary transition-colors">
                            <i class="ri-instagram-fill"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">For Workers</h4>
                    <ul class="space-y-3">
                        <li><a href="#" class="text-gray-400 hover:text-white">Find Jobs</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Create Profile</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Career Resources</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Success Stories</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">FAQ</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">For Clients</h4>
                    <ul class="space-y-3">
                        <li><a href="#" class="text-gray-400 hover:text-white">Post a Job</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Browse Talent</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Enterprise Solutions</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Success Stories</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Resources</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Company</h4>
                    <ul class="space-y-3">
                        <li><a href="/about" class="text-gray-400 hover:text-white">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Press</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Careers</a></li>
                        <li><a href="/help" class="text-gray-400 hover:text-white">Contact</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Blog</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <p class="text-gray-400">&copy; 2025 Iconnect. All rights reserved.</p>
                    </div>
                    <div class="flex flex-wrap justify-center gap-4">
                        <a href="#" class="text-gray-400 hover:text-white">Terms of Service</a>
                        <a href="#" class="text-gray-400 hover:text-white">Privacy Policy</a>
                        <a href="#" class="text-gray-400 hover:text-white">Cookie Policy</a>
                        <a href="#" class="text-gray-400 hover:text-white">Accessibility</a>
                    </div>
                    <div class="mt-4 md:mt-0 flex items-center space-x-3">
                        <i class="ri-visa-fill ri-lg"></i>
                        <i class="ri-mastercard-fill ri-lg"></i>
                        <i class="ri-paypal-fill ri-lg"></i>
                        <i class="ri-apple-fill ri-lg"></i>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Chat Widget -->
    <div class="fixed bottom-6 right-6 z-50">
        <button onclick="window.location.href = '/help';" class="w-14 h-14 flex items-center justify-center rounded-full bg-primary text-white shadow-lg hover:bg-primary/90">
            <i class="ri-message-3-line ri-lg"></i>
        </button>
    </div>

    <script>
        // Dark mode functionality
        document.addEventListener('DOMContentLoaded', function() {
            const toggle = document.getElementById('darkModeToggle');
            const icon = document.getElementById('themeIcon');
            
            if (localStorage.getItem('theme') === 'dark') {
                document.documentElement.classList.add('dark');
                icon.classList.remove('ri-sun-line');
                icon.classList.add('ri-moon-line');
            }
            
            toggle.addEventListener('click', () => {
                document.documentElement.classList.toggle('dark');
                const isDark = document.documentElement.classList.contains('dark');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                icon.classList.toggle('ri-sun-line');
                icon.classList.toggle('ri-moon-line');
            });
        });

        // Mobile menu toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const mobileNav = document.querySelector('nav');
            
            if (mobileMenuToggle && mobileNav) {
                mobileMenuToggle.addEventListener('click', function() {
                    mobileNav.classList.toggle('hidden');
                });
            }
        });

        // Account dropdown
        document.addEventListener('DOMContentLoaded', function() {
            const accountButton = document.getElementById('accountButton');
            const accountDropdown = document.getElementById('accountDropdown');
            const accountArrow = document.getElementById('accountArrow');
            
            if (accountButton && accountDropdown) {
                accountButton.addEventListener('click', function(e) {
                    e.stopPropagation();
                    accountDropdown.classList.toggle('show');
                    
                    // Rotate arrow icon
                    if (accountArrow) {
                        accountArrow.style.transform = accountDropdown.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
                    }
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', function(e) {
                    if (!accountButton.contains(e.target) && !accountDropdown.contains(e.target)) {
                        accountDropdown.classList.remove('show');
                        if (accountArrow) {
                            accountArrow.style.transform = 'rotate(0deg)';
                        }
                    }
                });

                // Close dropdown when clicking on a dropdown item
                const dropdownItems = accountDropdown.querySelectorAll('a');
                dropdownItems.forEach(item => {
                    item.addEventListener('click', function() {
                        accountDropdown.classList.remove('show');
                        if (accountArrow) {
                            accountArrow.style.transform = 'rotate(0deg)';
                        }
                    });
                });
            }
        });

        // Logout function
        function logout() {
            showModal(
                'Confirm Logout',
                'Are you sure you want to logout?',
                function() {
                    window.location.href = '/login_page';
                }
            );
        }
    </script>
    <script src="/static/main.js"></script>
</body>
</html>